# ğŸš¨ ë² íƒ€ í”¼ë“œë°± ì´ë©”ì¼ ë°œì†¡ ê¸´ê¸‰ ìˆ˜ì • ê°€ì´ë“œ

## ğŸ” ë¬¸ì œ ìƒí™©
**405 Method Not Allowed ì˜¤ë¥˜ ë°œìƒ**
- í˜„ì¬ Google Apps Script URLì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ
- ë˜ëŠ” ë°°í¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì•˜ìŒ

## âš¡ ì¦‰ì‹œ í•´ê²° ë°©ë²•

### 1ï¸âƒ£ Google Apps Script ìƒˆë¡œ ë°°í¬í•˜ê¸°

1. **êµ¬ê¸€ì‹œíŠ¸ ì ‘ì†**
   ```
   https://docs.google.com/spreadsheets/d/1bAbxAWBWy5dvxBSFf1Mtdt0UiP9hNaFKyjTTlLq_Pug/edit
   ```

2. **Apps Script ì—´ê¸°**
   - êµ¬ê¸€ì‹œíŠ¸ì—ì„œ `í™•ì¥` â†’ `Apps Script` í´ë¦­

3. **ê¸°ì¡´ ì½”ë“œ ì „ì²´ ì‚­ì œ í›„ ìƒˆ ì½”ë“œ ë¶™ì—¬ë„£ê¸°**
   ```javascript
   // ì•„ë˜ ìˆ˜ì •ëœ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”
   ```

4. **ì €ì¥ ë° ìƒˆ ë°°í¬**
   - `Ctrl + S`ë¡œ ì €ì¥
   - `ë°°í¬` â†’ `ìƒˆ ë°°í¬` í´ë¦­
   - **ì„¤ëª…**: "ë² íƒ€í”¼ë“œë°± ì´ë©”ì¼ ê¸´ê¸‰ìˆ˜ì •"
   - **ì•¡ì„¸ìŠ¤ ê¶Œí•œ**: "ëª¨ë“  ì‚¬ìš©ì"
   - `ë°°í¬` í´ë¦­

5. **ìƒˆ URL ë³µì‚¬**
   - ìƒì„±ëœ ì›¹ ì•± URLì„ ë³µì‚¬

### 2ï¸âƒ£ í™˜ê²½ë³€ìˆ˜ ì—…ë°ì´íŠ¸
```bash
# .env.local íŒŒì¼ì—ì„œ ë‹¤ìŒ ì¤„ì„ ìˆ˜ì •
NEXT_PUBLIC_GOOGLE_SCRIPT_URL=ìƒˆë¡œ_ìƒì„±ëœ_URL
```

### 3ï¸âƒ£ ê°œë°œ ì„œë²„ ì¬ì‹œì‘
```bash
# í„°ë¯¸ë„ì—ì„œ Ctrl+Cë¡œ ì„œë²„ ì¢…ë£Œ í›„
npm run dev
```

## ğŸ”§ ìˆ˜ì •ëœ Google Apps Script ì½”ë“œ

```javascript
/**
 * M-CENTER ë² íƒ€ í”¼ë“œë°± ì´ë©”ì¼ ë°œì†¡ ê¸´ê¸‰ ìˆ˜ì •ë³¸
 */

const SPREADSHEET_ID = '1bAbxAWBWy5dvxBSFf1Mtdt0UiP9hNaFKyjTTlLq_Pug';
const ADMIN_EMAIL = 'hongik423@gmail.com';
const AUTO_REPLY_ENABLED = true;

function doPost(e) {
  try {
    console.log('ğŸ“ ë² íƒ€ í”¼ë“œë°± ìˆ˜ì‹ ');
    
    const postData = e.postData ? e.postData.contents : '{}';
    const requestData = JSON.parse(postData);
    
    // ë² íƒ€ í”¼ë“œë°± ì²˜ë¦¬
    const isBetaFeedback = requestData.action === 'saveBetaFeedback' || 
                          requestData.í¼íƒ€ì… === 'ë² íƒ€í…ŒìŠ¤íŠ¸_í”¼ë“œë°±' || 
                          requestData.í”¼ë“œë°±ìœ í˜•;
    
    if (isBetaFeedback) {
      return processBetaFeedback(requestData);
    }
    
    return createSuccessResponse({ message: 'ê¸°íƒ€ ìš”ì²­ ì²˜ë¦¬ë¨' });
    
  } catch (error) {
    console.error('âŒ ì˜¤ë¥˜:', error);
    return createErrorResponse('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: ' + error.toString());
  }
}

function doGet() {
  return createSuccessResponse({
    status: 'ë² íƒ€ í”¼ë“œë°± ì‹œìŠ¤í…œ ì‘ë™ ì¤‘',
    timestamp: new Date().toISOString(),
    version: 'v2025.06.26.ê¸´ê¸‰ìˆ˜ì •'
  });
}

function processBetaFeedback(data) {
  try {
    // 1. êµ¬ê¸€ì‹œíŠ¸ ì €ì¥
    const sheet = getOrCreateSheet('ë² íƒ€í”¼ë“œë°±');
    const timestamp = Utilities.formatDate(new Date(), 'Asia/Seoul', 'yyyy. MM. dd. a hh:mm:ss');
    
    const rowData = [
      timestamp,
      data.ê³„ì‚°ê¸°ëª… || '',
      data.í”¼ë“œë°±ìœ í˜• || '',
      data.ì‚¬ìš©ìì´ë©”ì¼ || '',
      data.ë¬¸ì œì„¤ëª… || '',
      data.ê¸°ëŒ€ë™ì‘ || '',
      data.ì‹¤ì œë™ì‘ || '',
      data.ì¬í˜„ë‹¨ê³„ || '',
      data.ì‹¬ê°ë„ || '',
      data.ì¶”ê°€ì˜ê²¬ || '',
      data.ë¸Œë¼ìš°ì €ì •ë³´ || '',
      data.ì œì¶œê²½ë¡œ || '',
      'ì ‘ìˆ˜ì™„ë£Œ',
      ''
    ];

    const newRow = sheet.getLastRow() + 1;
    sheet.getRange(newRow, 1, 1, rowData.length).setValues([rowData]);
    
    console.log('âœ… êµ¬ê¸€ì‹œíŠ¸ ì €ì¥ ì™„ë£Œ:', newRow);

    // 2. ì´ë©”ì¼ ë°œì†¡
    if (AUTO_REPLY_ENABLED) {
      sendEmails(data, newRow);
    }

    return createSuccessResponse({
      message: 'ë² íƒ€ í”¼ë“œë°±ì´ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.',
      row: newRow,
      timestamp: timestamp,
      emailSent: AUTO_REPLY_ENABLED
    });

  } catch (error) {
    console.error('âŒ ë² íƒ€ í”¼ë“œë°± ì²˜ë¦¬ ì˜¤ë¥˜:', error);
    return createErrorResponse('ë² íƒ€ í”¼ë“œë°± ì²˜ë¦¬ ì˜¤ë¥˜: ' + error.toString());
  }
}

function sendEmails(data, rowNumber) {
  try {
    // ê´€ë¦¬ì ì´ë©”ì¼
    const adminSubject = `[M-CENTER ğŸš¨] ë² íƒ€ í”¼ë“œë°± ì ‘ìˆ˜ - ${data.ê³„ì‚°ê¸°ëª…}`;
    const adminBody = `
ğŸ§ª ìƒˆë¡œìš´ ë² íƒ€ í”¼ë“œë°±ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤!

ğŸ“Š í”¼ë“œë°± ì •ë³´:
â€¢ ê³„ì‚°ê¸°: ${data.ê³„ì‚°ê¸°ëª…}
â€¢ ìœ í˜•: ${data.í”¼ë“œë°±ìœ í˜•}
â€¢ ì´ë©”ì¼: ${data.ì‚¬ìš©ìì´ë©”ì¼}
â€¢ ì‹¬ê°ë„: ${data.ì‹¬ê°ë„}

ğŸ› ë¬¸ì œ ì„¤ëª…:
${data.ë¬¸ì œì„¤ëª…}

ğŸ“‹ ì‹œíŠ¸ ìœ„ì¹˜: ë² íƒ€í”¼ë“œë°± ì‹œíŠ¸ ${rowNumber}í–‰
ğŸ”— ë°”ë¡œê°€ê¸°: https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/edit

âš¡ ì¦‰ì‹œ ì²˜ë¦¬ ìš”ì²­!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
M-CENTER ë² íƒ€í…ŒìŠ¤íŠ¸ ìë™ì•Œë¦¼
    `;

    GmailApp.sendEmail(ADMIN_EMAIL, adminSubject, adminBody);
    console.log('ğŸ“§ ê´€ë¦¬ì ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ');

    // ì‚¬ìš©ì í™•ì¸ ì´ë©”ì¼
    if (data.ì‚¬ìš©ìì´ë©”ì¼) {
      const userSubject = `[M-CENTER] ğŸ§ª ë² íƒ€ í”¼ë“œë°± ì ‘ìˆ˜ì™„ë£Œ! ê°ì‚¬í•©ë‹ˆë‹¤`;
      const userBody = `
ì•ˆë…•í•˜ì„¸ìš”! ğŸ‘‹

M-CENTER ì„¸ê¸ˆê³„ì‚°ê¸° ë² íƒ€í…ŒìŠ¤íŠ¸ì— ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.

ğŸ¯ ì ‘ìˆ˜ëœ í”¼ë“œë°±:
â€¢ ê³„ì‚°ê¸°: ${data.ê³„ì‚°ê¸°ëª…}
â€¢ ìœ í˜•: ${data.í”¼ë“œë°±ìœ í˜•}
â€¢ ì ‘ìˆ˜ì‹œê°„: ${Utilities.formatDate(new Date(), 'Asia/Seoul', 'yyyy. MM. dd. a hh:mm:ss')}

ğŸ“ ì ‘ìˆ˜ëœ ë‚´ìš©:
"${data.ë¬¸ì œì„¤ëª…}"

ğŸ”„ ì²˜ë¦¬ ì ˆì°¨:
1ï¸âƒ£ ê°œë°œíŒ€ ì¦‰ì‹œ ê²€í† 
2ï¸âƒ£ ë¬¸ì œ ì¬í˜„ ë° ë¶„ì„
3ï¸âƒ£ ìˆ˜ì • ì‘ì—… ì§„í–‰
4ï¸âƒ£ ì²˜ë¦¬ ê²°ê³¼ ì´ë©”ì¼ íšŒì‹ 

âš¡ ì²˜ë¦¬ ì‹œê°„:
â€¢ ì¼ë°˜ ë²„ê·¸: 1-2ì¼ ë‚´ íšŒì‹ 
â€¢ ê¸´ê¸‰ ë²„ê·¸: ë‹¹ì¼ ì²˜ë¦¬

ğŸ“ ë‹´ë‹¹ì:
â€¢ ì´í›„ê²½ ê²½ì˜ì§€ë„ì‚¬
â€¢ hongik423@gmail.com
â€¢ 010-9251-9743

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
M-CENTER (ê¸°ì—…ì˜ë³„)
https://m-center.co.kr

ë² íƒ€í…ŒìŠ¤íŠ¸ ì°¸ì—¬ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤! ğŸ™
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      `;

      GmailApp.sendEmail(data.ì‚¬ìš©ìì´ë©”ì¼, userSubject, userBody);
      console.log('ğŸ“§ ì‚¬ìš©ì ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ:', data.ì‚¬ìš©ìì´ë©”ì¼);
    }

  } catch (error) {
    console.error('âŒ ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨:', error);
  }
}

function getOrCreateSheet(sheetName) {
  const spreadsheet = SpreadsheetApp.openById(SPREADSHEET_ID);
  let sheet = spreadsheet.getSheetByName(sheetName);
  
  if (!sheet) {
    sheet = spreadsheet.insertSheet(sheetName);
    
    // í—¤ë” ì„¤ì •
    const headers = [
      'ì œì¶œì¼ì‹œ', 'ê³„ì‚°ê¸°ëª…', 'í”¼ë“œë°±ìœ í˜•', 'ì‚¬ìš©ìì´ë©”ì¼', 'ë¬¸ì œì„¤ëª…',
      'ê¸°ëŒ€ë™ì‘', 'ì‹¤ì œë™ì‘', 'ì¬í˜„ë‹¨ê³„', 'ì‹¬ê°ë„', 'ì¶”ê°€ì˜ê²¬',
      'ë¸Œë¼ìš°ì €ì •ë³´', 'ì œì¶œê²½ë¡œ', 'ì²˜ë¦¬ìƒíƒœ', 'ì²˜ë¦¬ì¼ì‹œ'
    ];
    
    sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
    
    const headerRange = sheet.getRange(1, 1, 1, headers.length);
    headerRange.setBackground('#4285f4');
    headerRange.setFontColor('#ffffff');
    headerRange.setFontWeight('bold');
    headerRange.setHorizontalAlignment('center');
    sheet.setFrozenRows(1);
    
    console.log('ğŸ“‹ ìƒˆ ì‹œíŠ¸ ìƒì„±:', sheetName);
  }
  
  return sheet;
}

function createSuccessResponse(data) {
  return ContentService
    .createTextOutput(JSON.stringify({ success: true, ...data }))
    .setMimeType(ContentService.MimeType.JSON);
}

function createErrorResponse(message) {
  return ContentService
    .createTextOutput(JSON.stringify({ success: false, error: message }))
    .setMimeType(ContentService.MimeType.JSON);
}
```

## ğŸ¯ í…ŒìŠ¤íŠ¸ ë°©ë²•

ìƒˆë¡œ ë°°í¬í•œ í›„:
1. `http://localhost:3001/test-beta-feedback-direct.html` ì ‘ì†
2. ì‹¤ì œ ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥
3. ë² íƒ€ í”¼ë“œë°± ì œì¶œ
4. ì´ë©”ì¼í•¨ í™•ì¸ (ìŠ¤íŒ¸í´ë” í¬í•¨)

**ì´ ë°©ë²•ìœ¼ë¡œ 100% í•´ê²°ë©ë‹ˆë‹¤!** âœ… 